---
draft: true
date: 2025-08-26T16:38:00
title: 大二暑期第一段实习总结
---
# 实习总结报告

## 一、实习背景

在本次实习期间，我主要围绕 **云原生相关技术栈**（Kubernetes、RKE2、K3s、Harvester、Longhorn 等）展开学习与实践。通过阅读官方文档、源码和社区 PR，并结合实际测试环境，我逐步深入理解了 RKE2 的运行机制及其证书管理逻辑，并尝试进行源码修改和二次编译。

本次实习的目标主要包括：

1. 熟悉 RKE2 及其相关生态组件的工作原理；
    
2. 学习如何基于源码进行定制化功能开发与编译；
    
3. 掌握云原生集群环境下证书管理的实践方法；
    
4. 为未来在云原生领域的深入研究和应用打下基础。
    

---

## 二、实习工作内容

### 1. RKE2 证书时长修改与验证

- 基于 RKE2 v1.27.10+rke2r1 的源码，修改了证书生成逻辑，使其支持通过 `/etc/default/rke2-server` 文件自定义 **客户端证书有效期** 与 **CA 根证书有效期**；
    
- 修复了原版本中使用 `rke2 certificate rotate` 时部分客户端证书未更新的问题；
    
- 实现了二进制重新编译与替换，并在实际集群环境中进行验证；
    
- 编写了完整的使用说明与部署文档，涵盖配置、编译、证书验证、时间模拟测试等环节；
    
- 总结了目前已知的限制，例如 CA 根证书仍然会在到期后导致集群不可用。
    

### 2. 自定义证书有效期的编译与部署流程

- 修改 [`dynamiclistener`](https://github.com/rancher/dynamiclistener) 证书生成逻辑，支持从环境变量读取有效期配置；
    
- 完成 RKE2 二进制编译与运行时镜像导入，熟悉 RKE2 的构建与部署流程；
    
- 验证了 `CATTLE_NEW_SIGNED_CERT_EXPIRATION_DAYS` 和 `CATTLE_NEW_SIGNED_CA_EXPIRATION_YEARS` 参数的有效性；
    
- 编写了操作手册，包括安装、systemd 环境变量加载、证书检查命令等。
    

### 3. 测试与问题排查

- 通过修改系统时间模拟证书过期场景，验证自定义证书的稳定性；
    
- 对比 RKE2 官方新版本的实现（PR #4324），确认了官方方案与自研方案的差异；
    
- 在测试过程中发现的问题包括：
    
    - CA 根证书有效期仍不可控；
        
    - 自行编译的二进制可能在镜像、部署时存在兼容性风险；
        
    - 生产环境证书轮换的影响范围尚需进一步评估。
        

### 4. 其他学习内容

- 学习并实践了 **Kubernetes、RKE2、K3s、Harvester、Longhorn** 等云原生相关技术，了解其在企业级生产环境下的应用场景；
    
- 研究了 RKE2 集群架构（Server 节点与 Agent 节点的区别、etcd 管理方式、证书分发机制）；
    
- 尝试使用 Longhorn 存储项目，并了解其在数据同步与限流机制方面的改进思路。
    

---

## 三、实习成果

1. **技术文章**
    
    - 《关于 RKE2 1.27.10+rke2r1 修改证书时长的使用》
        
    - 《RKE2 自定义证书有效期的编译与部署流程》
        
2. **开源贡献**
    
    - GitHub 代码仓库：
        
        - [my-rke2](https://github.com/FXAZfung/my-rke2)
            
        - [my-dynamiclistener](https://github.com/FXAZfung/my-dynamiclistener)
            
    - 发布了二进制安装包，供测试与验证使用。
        
3. **能力提升**
    
    - 掌握了 RKE2 源码的定制化方法；
        
    - 提高了定位问题、编译调试与文档编写的能力；
        
    - 对云原生生态的整体架构与运维有了更清晰的理解。
        

---

## 四、问题与不足

- 对 **CA 根证书的长期有效性管理** 仍未找到较好的解决方案；
    
- 自行编译的 RKE2 在生产环境的可用性存在不确定性，缺乏大规模验证；
    
- 对 Kubernetes 更深层次的网络、存储、调度机制还需进一步研究；
    
- 对 Harvester、Longhorn 等项目仅停留在学习与测试阶段，缺乏完整的生产化实践。
    

---

## 五、未来展望

- 在后续学习与工作中，计划深入研究 Kubernetes 证书管理机制与集群升级策略；
    
- 探索更通用的证书轮换方案，避免因 CA 过期导致的集群不可用；
    
- 加强对云原生生态中 **存储、网络、虚拟化** 的理解与实践；
    
- 希望能在开源社区贡献更多代码，参与更多与云原生相关的项目开发与优化工作。
    

---

## 六、总结

本次实习不仅让我掌握了 RKE2 的基础使用方法，更通过源码分析与功能改造，真正理解了其内部证书管理机制。同时，我也对 Kubernetes 及其生态有了系统性的认识，锻炼了问题定位与解决的能力。

通过这段时间的学习与实践，我更加坚定了今后深入云原生与基础设施研发方向的决心，并希望将所学知识应用到更大规模、更复杂的分布式系统建设中。

